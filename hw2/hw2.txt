
何处设置的中断使能？
asm(STI)
系统何时处于中断屏蔽状态？

current = 0;
stmr(1000);
ivec(alltraps);
这几个时候

如果系统处于中断屏蔽状态，如何让其中断使能？
asm(STI)

系统产生中断后，CPU会做哪些事情？（在没有软件帮助的情况下）
1)CPU检查响应中断的条件是否满足。CPU响应中断的条件是：有来自于中断源的中断请求、CPU允许中断。如果中断响应条件不满足，则中断处理无法进行。
2)如果CPU响应中断，则CPU关中断，使其进入不可再次响应中断的状态。
3)保存被中断进程现场。为了在中断处理结束后能使进程正确地返回到中断点，系统必须保存当前处理器状态字PSW和程序计数器PC等的值。这些值一般保存在特定堆栈或硬件寄存器中。
4)分析中断原因，调用中断处理子程序。在多个中断请求同时发生时，处理优先级最高的中断源发出的中断请求。在系统中，为了处理上的方便，通常都是针对不同的中断源编制有不同的中断处理子程序(陷阱处理子程序)。这些子程序的人口地址(或陷阱指令的人口地址)存放在内存的特定单元中。再者，不同的中断源也对应着不同的处理器状态字PSW。这些不同的PSW被放在相应的内存单元中，与中断处理子程序人口地址一起构成中断向量。显然，根据中断或陷阱的种类，系统可由中断向量表迅速地找到该中断响应的优先级、中断处理子程序(或陷阱指令)的入口地址和对应的PSW。
5)执行中断处理子程序。对陷阱来说，在有些系统中则是通过陷阱指令向当前执行进程发出软中断信号后调用对应的处理子程序执行。
6)退出中断，恢复被中断进程的现场或调度新进程占据处理器。
7)开中断，CPU继续执行。

CPU执行RTI指令的具体完成工作是哪些？
检查当前是用户态还是内核态，只有是内核态才是合法的。
之后设置PC，SP等寄存器，同时切换回用户态（原子操作）
如果仍然有待等待的中断，那么执行中断
